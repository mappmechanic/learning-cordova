!function(t,e){"use strict";function n(){var t=document.querySelector(".app-active");null!==t.querySelector("div.backdrop-popover")&&t.removeChild(a),l.style.visibility="hidden",l=null}function i(e,n){if(void 0===n&&(n="left"),c=!0,e.style.visibility="visible",e.querySelector("ul").scrollTop=0,l=e,!e.classList.contains("active")){var i=document.querySelector(".app-page.app-active"),o=i.currentStyle||t.getComputedStyle(i);if("title"===n||"title-left"===n){var r=i.querySelector(".header-bar");e.style.top=r.offsetHeight+"px","title"===n?e.style.left=r.clientWidth/2+parseInt(o.marginLeft)-e.clientWidth/2+"px":e.style.left=16+parseInt(o.marginLeft)+"px"}else if("left"===n||"right"===n)e.style.top="12px","left"===n?e.style.left=16+parseInt(o.marginLeft)+"px":(e.style.left="auto",e.style.right="16px");else{var s=document.querySelector('.btn-popover[data-popover-id="'+e.id+'"]'),d=s.getBoundingClientRect();e.style.width=s.clientWidth+"px",e.style.top=d.top+"px",e.style.left=d.left+"px"}e.classList.contains("active")||e.classList.add("active"),i.appendChild(a)}}function o(e){c=!1,l=e,e.classList.contains("active")&&(e.classList.toggle("active"),t.setTimeout(function(){n()},250))}var r=!1,l=null,c=!1,a=document.createElement("div");a.classList.add("backdrop-popover");var s=function(t){for(var e={target:null,id:null,direction:null};t&&t!==document;t=t.parentNode){var n=t.getAttribute("data-popover-id");if(null!==n){e.target=t,e.id=n,e.direction="left",!t.classList.contains("title")&&t.classList.contains("pull-left")?e.direction="left":!t.classList.contains("title")&&t.parentNode.classList.contains("pull-left")?e.direction="left":t.classList.contains("title")&&t.classList.contains("pull-left")?e.direction="title-left":t.parentNode&&t.parentNode.classList.contains("pull-left")&&t.classList.contains("title")?e.direction="title-left":t.classList.contains("pull-right")?e.direction="right":t.parentNode&&t.parentNode.classList.contains("pull-right")?e.direction="right":t.classList.contains("center")?e.direction="title":t.parentNode&&t.parentNode.classList.contains("center")?e.direction="title":e.direction="button";break}}return e},d=function(t){for(var e,n=document.querySelectorAll(".popover");t&&t!==document;t=t.parentNode)for(e=n.length;e--;)if(n[e]===t&&t.classList.contains("active"))return t},u=function(t){for(;t&&t!==document;t=t.parentNode)if(t===l)return!0;return!1};document.on(e.event.start,function(t){t=t.originalEvent||t;var e=d(t.target);!e&&c&&o(l),r=!1}),document.on(e.event.move,function(t){t=t.originalEvent||t,r=!0}),document.on(e.event.end,function(t){var e=t.target,n=s(e);if(n.target){var c=document.querySelector("#"+n.id);c&&(c.classList.contains("active")&&!r?o(c):i(c,n.direction))}if(null!==e.parentNode&&u(e)&&!r){o(l),t=new CustomEvent("itemchanged",{detail:{item:e.textContent,target:t.target},bubbles:!0,cancelable:!0});for(var a=document.querySelectorAll('[data-popover-id="'+l.id+'"]'),d=a.length-1;d>=0;d--){var n=a[d];"true"===n.getAttribute("data-autobind")&&("textContent"in n?n.textContent=e.textContent:n.innerText=e.innerText)}l.dispatchEvent(t)}}),e.popover=function(t){if("undefined"==typeof t)return{closeActive:function(){var t=!!l;return t&&o(l),t}};var e="string"==typeof t?document.querySelector(t):t;if(null===e)throw new Error("The popover with ID "+t+" does not exist");return{open:function(){i(e)},close:function(){o(e)}}},t.phonon=e,"object"==typeof exports?module.exports=e.popover:"function"==typeof define&&define.amd&&define(function(){return e.popover})}("undefined"!=typeof window?window:this,window.phonon||{});